FROM cognexa/cxflow
MAINTAINER Cognexa Solutions s.r.o. <docker@cognexa.com>

RUN pacman --noconfirm --needed -S openmpi \
    && ln -s /usr/lib/openmpi/libmpi.so  /usr/lib/openmpi/libmpi.so.12 \
    && ln -s /usr/lib/openmpi/libmpi_cxx.so  /usr/lib/openmpi/libmpi_cxx.so.1 \
    && pacman --noconfirm -Scc

ENV LD_LIBRARY_PATH /usr/lib/openmpi:$LD_LIBRARY_PATH

RUN pip install --no-cache-dir https://cntk.ai/PythonWheel/GPU/cntk-2.0-cp36-cp36m-linux_x86_64.whl

# install cxflow-cntk
RUN pip install --no-cache-dir git+https://github.com/Cognexa/cxflow-cntk.git
