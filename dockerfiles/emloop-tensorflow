ARG tag="latest"
FROM iterait/emloop:"${tag}"
MAINTAINER Iterait a.s. <docker@iterait.com>

ARG tag
RUN if [ "${tag}" = "cuda" ]; then \
        pacman --noconfirm --needed -S python-tensorflow-opt-cuda; \
        pacman --noconfirm -Rdd nvidia-utils; \
        pacman --noconfirm -Rns $(pacman -Qtdq); \
    else \
        pacman --noconfirm --needed -S python-tensorflow-opt; \
    fi \
    && pacman --noconfirm --needed -S tensorboard \
    && sudo -u aur gpg --recv-keys 8C004C2F93481F6B \
    && sudo -u aur trizen --noconfirm --needed -S python-gast python-astor python-grpcio python-termcolor \
    && paccache -rfk0

# install emloop-tensorflow
RUN pip install --no-cache-dir git+https://github.com/iterait/emloop-tensorflow.git
